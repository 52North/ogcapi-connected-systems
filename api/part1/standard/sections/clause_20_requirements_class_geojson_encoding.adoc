:geojson-mediatype: application/geo+json


[[clause-encoding-geojson]]
=== Requirements Class "GeoJSON Format"

==== Overview

include::../requirements/encoding/geojson/requirements_class_geojson.adoc[]

This requirements class specifies how `Feature` descriptions provided through the API are encoded using the GeoJSON format.
All feature types defined by this Standard can be encoded as GeoJSON.

The server must also implement Requirements Class "GeoJSON" of {ogcapi-features-1}.



==== Media Type

The media type used for GeoJSON encoded resources is `{geojson-mediatype}`.

[requirement,model=ogc]
====
[%metadata]
identifier:: /req/geojson/mediatype-read

The server SHALL support the media type `{geojson-mediatype}` in the HTTP `Accept` header and respond with a JSON document corresponding to the requested resource type.
====

[requirement,model=ogc]
====
[%metadata]
identifier:: /req/geojson/mediatype-write

conditions:: The server implements <<clause-resource-crd,/req/create-replace-delete>>.

The server SHALL support the media type `{geojson-mediatype}` in the HTTP `Content-Type` header and parse the JSON body according to the resource type.
====


==== Link Relation Types

[requirement,model=ogc]
====
[%metadata]
identifier:: /req/geojson/relationtypes

For all associations encoded in the `links` member of the JSON response, the link relation type must be set to the association name.
====


==== Common Encoding Rules

[requirement,model=ogc]
====
[%metadata]
identifier:: /req/geojson/feature-attribute-mapping

A GeoJSON document representing a `Feature` resource SHALL implement the mappings specified in <<feature-attribute-geojson-mappings>>.
====

[#feature-attribute-geojson-mappings,reftext='{table-caption} {counter:table-num}']
.GeoJSON Mappings of Common Attributes
[width="100%",cols="3,3,10",options="header"]
|====
| *Attribute Name*   | *JSON Member*             | *Usage*
| `uniqueIdentifier` | `properties/uid`          | Value is a JSON string that is a valid URI.
| `name`             | `properties/name`         | Value is a JSON string.
| `description`      | `properties/description`  | Value is a JSON string.
|====



[[clause-geojson-system]]
==== System Representation

[requirement,model=ogc]
====
[%metadata]
identifier:: /req/geojson/system-schema

part:: A GeoJSON document containing a single `System` feature SHALL be valid against the JSON schema {geojson-system-schema}.

part:: A GeoJSON document containing a collection of `System` features SHALL be valid against the JSON schema {geojson-system-collection-schema}.
====

[requirement,model=ogc]
====
[%metadata]
identifier:: /req/geojson/system-mappings

A GeoJSON document representing a `System` resource SHALL implement the mappings specified in <<system-attribute-geojson-mappings>> and <<system-assoc-geojson-mappings>>.
====

[#system-attribute-geojson-mappings,reftext='{table-caption} {counter:table-num}']
.GeoJSON Encoding of System Attributes
[width="100%",cols="3,3,10",options="header"]
|====
| *Attribute Name* | *JSON Member*            | *Usage*
| `systemType`     | `properties/featureType` | Use the URI or CURIE from <<system-types>> as the value.
| `assetType`      | `properties/assetType`   | Use the URI or CURIE from <<asset-types>> as the value.
| `validTime`      | `properties/validTime`   | Value SHALL be a JSON array with min/max bounds encoded as a ISO8601 date/time string.
| `location`       | `geometry`               | Value SHALL be a GeoJSON `Point` geometry.
|====

[#system-assoc-geojson-mappings,reftext='{table-caption} {counter:table-num}']
.GeoJSON Encoding of System Associations
[width="100%",cols="3,3,10",options="header"]
|====
| *Association Name*  | *JSON Member*                | *Usage*
| `procedure`         | `properties/procedure@link`  | Value is a weblink resolving to a `Procedure` resource.
| `subsystems`        | `links`                      | Value is a weblink resolving to a `System` collection.
| `samplingFeatures`  | `links`                      | Value is a weblink resolving to a `Sampling Features` collection.
| `datastreams`       | `links`                      | Value is a weblink resolving to a `DataStream` collection.
| `controlstreams`    | `links`                      | Value is a weblink resolving to a `ControlStream` collection.
| `deployments`       | `links`                      | Value is a weblink resolving to a `Deployment` collection.
|====

[[example_geojson_sys1]]
.A System Feature in GeoJSON format
=================
This is a simple description of a fixed in-situ sensor in GeoJSON, with a link to its alternate SensorML representation.
[source%autofit,json]
----
include::../openapi/examples/systems/thermometer-sensor-geojson.links.json[]
----
=================



[[clause-geojson-procedure]]
==== Procedure Representation

[requirement,model=ogc]
====
[%metadata]
identifier:: /req/geojson/procedure-schema

part:: A GeoJSON document containing a single `Procedure` feature SHALL be valid against the JSON schema {geojson-procedure-schema}.

part:: A GeoJSON document containing a collection of `Procedure` features SHALL be valid against the JSON schema {geojson-procedure-collection-schema}.
====

[requirement,model=ogc]
====
[%metadata]
identifier:: /req/geojson/procedure-mappings

A GeoJSON document representing a `Procedure` resource SHALL implement the mappings specified in <<procedure-attribute-geojson-mappings>> and <<procedure-assoc-geojson-mappings>>.
====

[#procedure-attribute-geojson-mappings,reftext='{table-caption} {counter:table-num}']
.GeoJSON Encoding of Procedure Attributes
[width="100%",cols="3,3,10",options="header"]
|====
| *Attribute Name* | *JSON Member*            | *Usage*
| `procedureType`  | `properties/featureType` | Use the URI or CURIE from <<procedure-types>> as the value.
| `validTime`      | `properties/validTime`   | Value SHALL be a JSON array with min/max bounds encoded as a ISO8601 date/time string.
|====

[#procedure-assoc-geojson-mappings,reftext='{table-caption} {counter:table-num}']
.GeoJSON Encoding of Procedure Associations
[width="100%",cols="3,3,10",options="header"]
|====
| *Association Name*     | *JSON Member* | *Usage*
| `implementingSystems`  | `links`       | Value is a weblink resolving to a `System` collection.
|====

[[example_geojson_proc1]]
.A Procedure Feature in GeoJSON format
=================
[source%autofit,json]
----
include::../openapi/examples/procedures/sensor-datasheet-geojson.json[]
----
=================



[[clause-geojson-deployment]]
==== Deployment Representation

[requirement,model=ogc]
====
[%metadata]
identifier:: /req/geojson/deployment-schema

part:: A GeoJSON document containing a single `Deployment` feature SHALL be valid against the JSON schema {geojson-deployment-schema}.

part:: A GeoJSON document containing a collection of `Deployment` features SHALL be valid against the JSON schema {geojson-deployment-collection-schema}.
====

[requirement,model=ogc]
====
[%metadata]
identifier:: /req/geojson/deployment-mappings

A GeoJSON document representing a `Deployment` resource SHALL implement the mappings specified in <<deployment-attribute-geojson-mappings>> and <<deployment-assoc-geojson-mappings>>.
====

[#deployment-attribute-geojson-mappings,reftext='{table-caption} {counter:table-num}']
.GeoJSON Encoding of Deployment Attributes
[width="100%",cols="3,3,10",options="header"]
|====
| *Attribute Name* | *JSON Member*                | *Usage*
| `deploymentType` | `properties/featureType`     | Use the URI or CURIE from <<deployment-types>> as the value.
| `validTime`      | `properties/validTime`       | -
| `location`       | `geometry`                   | Value is a GeoJSON geometry
|====

[#deployment-assoc-geojson-mappings,reftext='{table-caption} {counter:table-num}']
.GeoJSON Encoding of Deployment Associations
[width="100%",cols="3,3,10",options="header"]
|====
| *Association Name*    | *JSON Member* | *Usage*
| `deployedSystems`     | `links`       | Value is a weblink resolving to a `System` collection.
| `featuresOfInterest`  | `links`       | Value is a weblink resolving to a `Feature` collection.
| `datastreams`         | `links`       | Value is a weblink resolving to a `DataStream` collection.
| `controlstreams`      | `links`       | Value is a weblink resolving to a `ControlStream` collection.
|====

[[example_geojson_dep1]]
.A Deployment Feature in GeoJSON format
=================
[source%autofit,json]
----
include::../openapi/examples/deployments/deployment-geojson.json[]
----
=================



[[clause-geojson-deployed-system]]
==== Deployed System Representation

[requirement,model=ogc]
====
[%metadata]
identifier:: /req/geojson/deployed-system-schema

part:: A GeoJSON document containing a single `Deployed System` resource SHALL be valid against the JSON schema {geojson-deployed-system-schema}.

part:: A GeoJSON document containing a collection of `Deployed System` resources SHALL be valid against the JSON schema {geojson-deployed-system-schema}.
====

[requirement,model=ogc]
====
[%metadata]
identifier:: /req/geojson/deployed-system-mappings

A GeoJSON document representing a `Deployed System` resource SHALL implement the mappings specified in <<dep-sys-geojson-mappings>>.
====

[#dep-sys-geojson-mappings,reftext='{table-caption} {counter:table-num}']
.GeoJSON Encoding of Deployed System Associations
[width="100%",cols="3,3,10",options="header"]
|====
| *Association Name* | *JSON Member*               | *Usage*
| `system`           | `properties/system@link`    | Value is a weblink resolving to a single `System` resource.
| `procedure`        | `properties/procedure@link` | Value is a weblink resolving to a single `Procedure` resource.
|====

[[example_geojson_depsys1]]
.A Deployed System resource in GeoJSON format
=================
[source%autofit,json]
----
include::../openapi/examples/deployments/deployedSystems/deployed-system-geojson.json[]
----
=================



[[clause-geojson-sf]]
==== Sampling Feature Representation

[requirement,model=ogc]
====
[%metadata]
identifier:: /req/geojson/sf-schema

conditions:: The server implements <<clause-sampling-features,/req/sampling-features>>.

part:: A GeoJSON document containing a single `Sampling Feature` SHALL be valid against the JSON schema {geojson-samplingFeature-schema}.

part:: A GeoJSON document containing a collection of `Sampling Features` SHALL be valid against the JSON schema {geojson-samplingFeature-collection-schema}.
====

[requirement,model=ogc]
====
[%metadata]
identifier:: /req/geojson/sf-mappings

A GeoJSON document representing a `Sampling Feature` resource SHALL implement the mappings specified in <<sf-attribute-geojson-mappings>> and <<sf-assoc-geojson-mappings>>.
====

[#sf-attribute-geojson-mappings,reftext='{table-caption} {counter:table-num}']
.GeoJSON Encoding of Sampling Feature Attributes
[width="100%",cols="3,3,10",options="header"]
|====
| *Attribute Name* | *JSON Member*            | *Usage*
| `featureType`    | `properties/featureType` | Use the URI or CURIE provided in <<clause-sampling-feature-types>>.
| `validTime`      | `properties/validTime`   | Value SHALL be a JSON array with min/max bounds encoded as a ISO8601 date/time string.
|====

[#sf-assoc-geojson-mappings,reftext='{table-caption} {counter:table-num}']
.GeoJSON Encoding of Sampling Feature Associations
[width="100%",cols="3,3,10",options="header"]
|====
| *Association Name*         | *JSON Member*                    | *Usage*
| `system`                   | `properties/system@link`         | Value is a weblink resolving to a `System` resource.
| `sampledFeature`           | `properties/sampledFeature@link` | Value is a weblink resolving to a `Feature` resource.
| `relatedSamplingFeatures`  | -                                | Value is a weblink resolving to a `Sampling Feature` collection.
| `dataStreams`              | -                                | Value is a weblink resolving to a `DataStream` collection.
| `controlStreams`           | -                                | Value is a weblink resolving to a `ControlStream` collection.
|====


[[example_sf1]]
.A Sampling Point Feature in GeoJSON format
=================
[source%autofit,json]
----
include::../openapi/examples/sampling/sampling-point-geojson.json[]
----
=================

[[example_sf2]]
.A Specimen Feature in GeoJSON format
=================
[source%autofit,json]
----
include::../openapi/examples/sampling/sampling-specimen-geojson.json[]
----
=================

[[example_sf3]]
.A System Part Feature in GeoJSON format
=================
[source%autofit,json]
----
include::../openapi/examples/sampling/sampling-part-geojson.json[]
----
=================


[[clause-geojson-batch]]
==== Batch Mode

[requirement,model=ogc]
====
[%metadata]
identifier:: /req/geojson/batch-format

conditions:: The server implements <<clause-resource-crd,/req/create-replace-delete>>.

A BATCH CREATE or BATCH REPLACE request body SHALL be a valid GeoJSON `FeatureCollection` document.
====